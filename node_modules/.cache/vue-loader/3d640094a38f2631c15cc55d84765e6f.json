{"remainingRequest":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\orderJD\\confirmOrder\\ConfirmOrderJd.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\orderJD\\confirmOrder\\ConfirmOrderJd.vue","mtime":1617703301507},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEZWZBZGRyZXNzV2FwIGZyb20gImNvbXBvbmVudHMvY29udGVudC9jb25maXJtT3JkZXIvRGVmQWRkcmVzc1dyYXAudnVlIjsKaW1wb3J0IE9yZGVySW5mb1dyYXAgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2NvbmZpcm1PcmRlci9PcmRlckluZm9XcmFwLnZ1ZSI7CgppbXBvcnQgT3JkZXJOYXZCYXIgZnJvbSAiLi9jaGlsZENvbXBzL09yZGVyTmF2QmFyLnZ1ZSI7CmltcG9ydCBDaGVja091dCBmcm9tICIuL2NoaWxkQ29tcHMvQ2hlY2tPdXQiOwoKaW1wb3J0IHsgZ2V0TWFzdEFkZHJlc3MgfSBmcm9tICJuZXR3b3JrL2FkZHJlc3MiOwppbXBvcnQgeyBnZXRPcmRlckZyZWlnaHQgfSBmcm9tICJuZXR3b3JrL2pkT3JkZXIiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgT3JkZXJOYXZCYXIsCiAgICBEZWZBZGRyZXNzV2FwLAogICAgT3JkZXJJbmZvV3JhcCwKICAgIENoZWNrT3V0LAogIH0sCiAgbmFtZTogIkpkQ29uZmlybU9yZGVyIiwKICBjcmVhdGVkKCkgewogICAgdGhpcy5fZ2V0TWFzdEFkZHJlc3MoKTsKICAgIHRoaXMuX3NldE9yZGVySW5mbygpOwogICAgdGhpcy5fZ2V0T3JkZXJGcmVpZ2h0KCk7CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGVmQWRkcmVzczoge30sCiAgICAgIG9yZGVySW5mbzogW10sCiAgICAgIGNoZWNrSW5mbzoge30sCiAgICAgIGZyZWlnaHQ6IDAsCiAgICAgIG9yZGVyUHJpY2U6IDAsCiAgICAgIGFkZHJlc3NJZDogMCwKICAgICAgaXNkZWZBZGRyZXNzOiBmYWxzZSwKICAgICAgaXNGcmVpZ2h0OiBmYWxzZSwKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBfc2V0T3JkZXJJbmZvKCkgewogICAgICAvL+WVhuWTgeivpuaDhQogICAgICBjb25zdCBzdXVtaXRUeXBlID0gdGhpcy4kcm91dGUucXVlcnkuc3VibWl0VHlwZTsKICAgICAgLy89PTEg6LSt54mp6L2m5o+Q5LqkCiAgICAgIGlmIChzdXVtaXRUeXBlID09ICIxIikgewogICAgICAgIHRoaXMub3JkZXJJbmZvID0gSlNPTi5wYXJzZSgKICAgICAgICAgIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImNvbmZpcm1JdGVtcyIpIHx8ICJ7fSIKICAgICAgICApOwogICAgICB9CiAgICB9LAogICAgX2dldE1hc3RBZGRyZXNzKCkgewogICAgICAvL+m7mOiupOaUtui0p+WcsOWdgAogICAgICBnZXRNYXN0QWRkcmVzcygpLnRoZW4oKHJlcykgPT4gewogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgdGhpcy5pc2RlZkFkZHJlc3MgPSB0cnVlOwogICAgICAgICAgdGhpcy5hZGRyZXNzSWQgPSByZXMucmVzdWx0LmlkOwogICAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCh7CiAgICAgICAgICAgIHR5cGU6ICJzZXREZWZBZGRyZXNzIiwKICAgICAgICAgICAgZGVmQWRkcmVzczogcmVzLnJlc3VsdC5hcmVhX3N0cl9pZHMsCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZGVmQWRkcmVzcyA9IHJlcy5yZXN1bHQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBfZ2V0T3JkZXJGcmVpZ2h0KCkgewogICAgICAvL+iuouWNlei/kOi0uQogICAgICBsZXQgcXVlcnlNb2RlbCA9IG5ldyBPYmplY3QoKTsKICAgICAgcXVlcnlNb2RlbC5kZWZBZGRyZXNzID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXREZWZBZGRyZXNzOwogICAgICBxdWVyeU1vZGVsLnNrdVV1bXMgPSB0aGlzLmdldFNrdSgpOwoKICAgICAgZ2V0T3JkZXJGcmVpZ2h0KHF1ZXJ5TW9kZWwpLnRoZW4oKHJlcykgPT4gewogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgdGhpcy5pc0ZyZWlnaHQgPSB0cnVlOwogICAgICAgICAgdGhpcy5mcmVpZ2h0ID0gcmVzLnJlc3VsdC5mcmVpZ2h0OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY29uZmlybU9yZGVyKCkgewogICAgICAvL+aPkOS6pOiuouWNlQogICAgICBsZXQgcXVlcnlNb2RlbCA9IG5ldyBPYmplY3QoKTsKICAgICAgcXVlcnlNb2RlbC5hZGRyZXNzSWQgPSB0aGlzLmFkZHJlc3NJZDsKICAgICAgcXVlcnlNb2RlbC5za3VzID0gdGhpcy5nZXRTa3UoKTsKCiAgICAgIHRoaXMuJHN0b3JlCiAgICAgICAgLmRpc3BhdGNoKCJzdWJtaXRPcmRlciIsIHsKICAgICAgICAgIHF1ZXJ5TW9kZWw6IHF1ZXJ5TW9kZWwsCiAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzICE9PSAiIikgewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgcGF0aDogIi9QYXlPcmRlckpkIiwKICAgICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgICAgb3JkZXJfc246IHJlcywKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLmj5DkuqTlpLHotKUiKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBnZXRTa3UoKSB7CiAgICAgIGxldCBsaXN0U2t1TW9kZWwgPSBbXTsKICAgICAgdGhpcy5vcmRlckluZm8uZm9yRWFjaCgoZWxlbWVudCkgPT4gewogICAgICAgIGxldCBza3VNb2RlbCA9IHt9OwogICAgICAgIHNrdU1vZGVsLnNrdUlkID0gZWxlbWVudC5za3VpZDsKICAgICAgICBza3VNb2RlbC5udW0gPSBlbGVtZW50LnByb2R1Y3RfbnVtOwogICAgICAgIGxpc3RTa3VNb2RlbC5wdXNoKHNrdU1vZGVsKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBsaXN0U2t1TW9kZWw7CiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIG9yZGVySW5mbygpIHsKICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMub3JkZXJJbmZvKS5sZW5ndGggIT09IDApIHsKICAgICAgICB0aGlzLm9yZGVyUHJpY2UgPSB0aGlzLm9yZGVySW5mbwogICAgICAgICAgLnJlZHVjZSgocHJlVmFsdWUsIGl0ZW0pID0+IHsKICAgICAgICAgICAgcmV0dXJuIHByZVZhbHVlICsgaXRlbS5wcm9kdWN0X251bSAqIGl0ZW0ucHJvZHVjdF9wdHByaWNlOwogICAgICAgICAgfSwgMCkKICAgICAgICAgIC50b0ZpeGVkKDIpOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["ConfirmOrderJd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ConfirmOrderJd.vue","sourceRoot":"src/views/orderJD/confirmOrder","sourcesContent":["<template>\n  <div id=\"jdconfirmorder\" v-if=\"this.$route.query.submitType != undefined\">\n    <order-nav-bar />\n\n    <def-address-wap :defAddress=\"defAddress\" />\n    <order-info-wrap :orderInfo=\"orderInfo\" />\n    <check-out :orderPrice=\"orderPrice\" :freightPrice=\"freight\" />\n    <div v-if=\"isdefAddress && isFreight\">\n      <button @click=\"confirmOrder\">在线支付</button>\n    </div>\n  </div>\n  <div v-else>\n    <h1>无效的请求</h1>\n  </div>\n</template>\n\n<script>\nimport DefAddressWap from \"components/content/confirmOrder/DefAddressWrap.vue\";\nimport OrderInfoWrap from \"components/content/confirmOrder/OrderInfoWrap.vue\";\n\nimport OrderNavBar from \"./childComps/OrderNavBar.vue\";\nimport CheckOut from \"./childComps/CheckOut\";\n\nimport { getMastAddress } from \"network/address\";\nimport { getOrderFreight } from \"network/jdOrder\";\nexport default {\n  components: {\n    OrderNavBar,\n    DefAddressWap,\n    OrderInfoWrap,\n    CheckOut,\n  },\n  name: \"JdConfirmOrder\",\n  created() {\n    this._getMastAddress();\n    this._setOrderInfo();\n    this._getOrderFreight();\n  },\n  data() {\n    return {\n      defAddress: {},\n      orderInfo: [],\n      checkInfo: {},\n      freight: 0,\n      orderPrice: 0,\n      addressId: 0,\n      isdefAddress: false,\n      isFreight: false,\n    };\n  },\n  methods: {\n    _setOrderInfo() {\n      //商品详情\n      const suumitType = this.$route.query.submitType;\n      //==1 购物车提交\n      if (suumitType == \"1\") {\n        this.orderInfo = JSON.parse(\n          sessionStorage.getItem(\"confirmItems\") || \"{}\"\n        );\n      }\n    },\n    _getMastAddress() {\n      //默认收货地址\n      getMastAddress().then((res) => {\n        if (res.success) {\n          this.isdefAddress = true;\n          this.addressId = res.result.id;\n          console.log(res);\n          this.$store.commit({\n            type: \"setDefAddress\",\n            defAddress: res.result.area_str_ids,\n          });\n          this.defAddress = res.result;\n        }\n      });\n    },\n    _getOrderFreight() {\n      //订单运费\n      let queryModel = new Object();\n      queryModel.defAddress = this.$store.getters.getDefAddress;\n      queryModel.skuUums = this.getSku();\n\n      getOrderFreight(queryModel).then((res) => {\n        if (res.success) {\n          this.isFreight = true;\n          this.freight = res.result.freight;\n        }\n      });\n    },\n    confirmOrder() {\n      //提交订单\n      let queryModel = new Object();\n      queryModel.addressId = this.addressId;\n      queryModel.skus = this.getSku();\n\n      this.$store\n        .dispatch(\"submitOrder\", {\n          queryModel: queryModel,\n        })\n        .then((res) => {\n          if (res !== \"\") {\n            this.$router.push({\n              path: \"/PayOrderJd\",\n              query: {\n                order_sn: res,\n              },\n            });\n          } else {\n            console.log(\"提交失败\");\n          }\n        });\n    },\n    getSku() {\n      let listSkuModel = [];\n      this.orderInfo.forEach((element) => {\n        let skuModel = {};\n        skuModel.skuId = element.skuid;\n        skuModel.num = element.product_num;\n        listSkuModel.push(skuModel);\n      });\n      return listSkuModel;\n    },\n  },\n  watch: {\n    orderInfo() {\n      if (Object.keys(this.orderInfo).length !== 0) {\n        this.orderPrice = this.orderInfo\n          .reduce((preValue, item) => {\n            return preValue + item.product_num * item.product_ptprice;\n          }, 0)\n          .toFixed(2);\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>\n"]}]}