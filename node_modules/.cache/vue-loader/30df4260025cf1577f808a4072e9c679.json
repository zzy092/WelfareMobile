{"remainingRequest":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\orderJD\\confirmOrder\\ConfirmOrderJD.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\orderJD\\confirmOrder\\ConfirmOrderJD.vue","mtime":1617696230736},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEZWZBZGRyZXNzV2FwIGZyb20gImNvbXBvbmVudHMvY29udGVudC9jb25maXJtT3JkZXIvRGVmQWRkcmVzc1dyYXAudnVlIjsKaW1wb3J0IE9yZGVySW5mb1dyYXAgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2NvbmZpcm1PcmRlci9PcmRlckluZm9XcmFwLnZ1ZSI7CgppbXBvcnQgT3JkZXJOYXZCYXIgZnJvbSAiLi4vLi4vamRDb25maXJtT3JkZXIvY2hpbGRDb21wcy9PcmRlck5hdkJhci52dWUiOwppbXBvcnQgQ2hlY2tPdXQgZnJvbSAiLi9jaGlsZENvbXBzL0NoZWNrT3V0IjsKCmltcG9ydCB7IGdldE1hc3RBZGRyZXNzIH0gZnJvbSAibmV0d29yay9hZGRyZXNzIjsKaW1wb3J0IHsgZ2V0T3JkZXJGcmVpZ2h0LCBzdWJtaXRPcmRlciB9IGZyb20gIm5ldHdvcmsvamRPcmRlciI7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBPcmRlck5hdkJhciwKICAgIERlZkFkZHJlc3NXYXAsCiAgICBPcmRlckluZm9XcmFwLAogICAgQ2hlY2tPdXQsCiAgfSwKICBuYW1lOiAiSmRDb25maXJtT3JkZXIiLAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLl9nZXRNYXN0QWRkcmVzcygpOwogICAgdGhpcy5fc2V0T3JkZXJJbmZvKCk7CiAgICB0aGlzLl9nZXRPcmRlckZyZWlnaHQoKTsKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkZWZBZGRyZXNzOiB7fSwKICAgICAgb3JkZXJJbmZvOiBbXSwKICAgICAgY2hlY2tJbmZvOiB7fSwKICAgICAgZnJlaWdodDogMCwKICAgICAgb3JkZXJQcmljZTogMCwKICAgICAgYWRkcmVzc0lkOiAwLAogICAgICBpc2RlZkFkZHJlc3M6IGZhbHNlLAogICAgICBpc0ZyZWlnaHQ6IGZhbHNlLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIF9zZXRPcmRlckluZm8oKSB7IC8v5ZWG5ZOB6K+m5oOFCiAgICAgIGNvbnN0IHN1dW1pdFR5cGUgPSB0aGlzLiRyb3V0ZS5xdWVyeS5zdWJtaXRUeXBlOwogICAgICAvLz09MSDotK3nianovabmj5DkuqQKICAgICAgaWYgKHN1dW1pdFR5cGUgPT0gIjEiKSB7CiAgICAgICAgdGhpcy5vcmRlckluZm89SlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJjb25maXJtSXRlbXMiKSB8fCAie30iKTsKICAgICAgfQogICAgfSwKICAgIF9nZXRNYXN0QWRkcmVzcygpIHsgLy/pu5jorqTmlLbotKflnLDlnYAKICAgICAgZ2V0TWFzdEFkZHJlc3MoKS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHRoaXMuaXNkZWZBZGRyZXNzID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuYWRkcmVzc0lkID0gcmVzLnJlc3VsdC5pZDsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoewogICAgICAgICAgICB0eXBlOiAic2V0RGVmQWRkcmVzcyIsCiAgICAgICAgICAgIGRlZkFkZHJlc3M6IHJlcy5yZXN1bHQuYXJlYV9zdHJfaWRzLAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRlZkFkZHJlc3MgPSByZXMucmVzdWx0OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgX2dldE9yZGVyRnJlaWdodCgpIHsgIC8v6K6i5Y2V6L+Q6LS5CiAgICAgIGxldCBxdWVyeU1vZGVsID0gbmV3IE9iamVjdCgpOwogICAgICBxdWVyeU1vZGVsLmRlZkFkZHJlc3MgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERlZkFkZHJlc3M7CiAgICAgIHF1ZXJ5TW9kZWwuc2t1VXVtcyA9IHRoaXMuZ2V0U2t1KCk7CgogICAgICBnZXRPcmRlckZyZWlnaHQocXVlcnlNb2RlbCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLmlzRnJlaWdodCA9IHRydWU7CiAgICAgICAgICB0aGlzLmZyZWlnaHQgPSByZXMucmVzdWx0LmZyZWlnaHQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjb25maXJtT3JkZXIoKSB7ICAvL+aPkOS6pOiuouWNlQogICAgICBsZXQgcXVlcnlNb2RlbD1uZXcgT2JqZWN0KCk7CiAgICAgIHF1ZXJ5TW9kZWwuYWRkcmVzc0lkPXRoaXMuYWRkcmVzc0lkOwogICAgICBxdWVyeU1vZGVsLnNrdXM9dGhpcy5nZXRTa3UoKTsKICAgICAgcXVlcnlNb2RlbC5wYXlNb25leT10aGlzLm9yZGVyUHJpY2UrdGhpcy5mcmVpZ2h0OwogICAgICBzdWJtaXRPcmRlcihxdWVyeU1vZGVsKS50aGVuKHJlcz0+ewogICAgICAgIGlmKHJlcy5zdWNjZXNzKXsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgICAgY29uc29sZS5sb2coJ+aPkOS6pOiuouWNleaIkOWKnycpOwogICAgICAgICAgLy/mkLrluKborqLljZVpZCDot7Povawg5pSv5LuY6aG16Z2iCgogICAgICAgIH1lbHNlewogICAgICAgICAgY29uc29sZS5sb2cocmVzLnJlc3VsdE1lc3NhZ2UpOwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBnZXRTa3UoKSB7CiAgICAgIGxldCBsaXN0U2t1TW9kZWwgPSBbXTsKICAgICAgdGhpcy5vcmRlckluZm8uZm9yRWFjaCgoZWxlbWVudCkgPT4gewogICAgICAgIGxldCBza3VNb2RlbCA9IHt9OwogICAgICAgIHNrdU1vZGVsLnNrdUlkID0gZWxlbWVudC5za3VpZDsKICAgICAgICBza3VNb2RlbC5udW0gPSBlbGVtZW50LnByb2R1Y3RfbnVtOwogICAgICAgIGxpc3RTa3VNb2RlbC5wdXNoKHNrdU1vZGVsKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBsaXN0U2t1TW9kZWw7CiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIG9yZGVySW5mbygpIHsKICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMub3JkZXJJbmZvKS5sZW5ndGggIT09IDApIHsKICAgICAgICB0aGlzLm9yZGVyUHJpY2UgPSB0aGlzLm9yZGVySW5mbwogICAgICAgICAgLnJlZHVjZSgocHJlVmFsdWUsIGl0ZW0pID0+IHsKICAgICAgICAgICAgcmV0dXJuIHByZVZhbHVlICsgaXRlbS5wcm9kdWN0X251bSAqIGl0ZW0ucHJvZHVjdF9wdHByaWNlOwogICAgICAgICAgfSwgMCkKICAgICAgICAgIC50b0ZpeGVkKDIpOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["ConfirmOrderJD.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ConfirmOrderJD.vue","sourceRoot":"src/views/orderJD/confirmOrder","sourcesContent":["<template>\n  <div id=\"jdconfirmorder\" v-if=\"this.$route.query.submitType != undefined\">\n    <order-nav-bar />\n\n    <def-address-wap :defAddress=\"defAddress\" />\n    <order-info-wrap :orderInfo=\"orderInfo\" />\n    <check-out :orderPrice=\"orderPrice\" :freightPrice=\"freight\" />\n    <div v-if=\"isdefAddress&&isFreight\">\n      <button @click=\"confirmOrder\">在线支付</button>\n    </div>\n  </div>\n  <div v-else>\n    <h1>无效的请求</h1>\n  </div>\n</template>\n\n<script>\nimport DefAddressWap from \"components/content/confirmOrder/DefAddressWrap.vue\";\nimport OrderInfoWrap from \"components/content/confirmOrder/OrderInfoWrap.vue\";\n\nimport OrderNavBar from \"../../jdConfirmOrder/childComps/OrderNavBar.vue\";\nimport CheckOut from \"./childComps/CheckOut\";\n\nimport { getMastAddress } from \"network/address\";\nimport { getOrderFreight, submitOrder } from \"network/jdOrder\";\nexport default {\n  components: {\n    OrderNavBar,\n    DefAddressWap,\n    OrderInfoWrap,\n    CheckOut,\n  },\n  name: \"JdConfirmOrder\",\n  created() {\n    this._getMastAddress();\n    this._setOrderInfo();\n    this._getOrderFreight();\n  },\n  data() {\n    return {\n      defAddress: {},\n      orderInfo: [],\n      checkInfo: {},\n      freight: 0,\n      orderPrice: 0,\n      addressId: 0,\n      isdefAddress: false,\n      isFreight: false,\n    };\n  },\n  methods: {\n    _setOrderInfo() { //商品详情\n      const suumitType = this.$route.query.submitType;\n      //==1 购物车提交\n      if (suumitType == \"1\") {\n        this.orderInfo=JSON.parse(sessionStorage.getItem(\"confirmItems\") || \"{}\");\n      }\n    },\n    _getMastAddress() { //默认收货地址\n      getMastAddress().then((res) => {\n        if (res.success) {\n          this.isdefAddress = true;\n          this.addressId = res.result.id;\n          console.log(res);\n          this.$store.commit({\n            type: \"setDefAddress\",\n            defAddress: res.result.area_str_ids,\n          });\n          this.defAddress = res.result;\n        }\n      });\n    },\n    _getOrderFreight() {  //订单运费\n      let queryModel = new Object();\n      queryModel.defAddress = this.$store.getters.getDefAddress;\n      queryModel.skuUums = this.getSku();\n\n      getOrderFreight(queryModel).then((res) => {\n        if (res.success) {\n          this.isFreight = true;\n          this.freight = res.result.freight;\n        }\n      });\n    },\n    confirmOrder() {  //提交订单\n      let queryModel=new Object();\n      queryModel.addressId=this.addressId;\n      queryModel.skus=this.getSku();\n      queryModel.payMoney=this.orderPrice+this.freight;\n      submitOrder(queryModel).then(res=>{\n        if(res.success){\n          console.log(res);\n\n          console.log('提交订单成功');\n          //携带订单id 跳转 支付页面\n\n        }else{\n          console.log(res.resultMessage);\n        }\n      })\n    },\n    getSku() {\n      let listSkuModel = [];\n      this.orderInfo.forEach((element) => {\n        let skuModel = {};\n        skuModel.skuId = element.skuid;\n        skuModel.num = element.product_num;\n        listSkuModel.push(skuModel);\n      });\n      return listSkuModel;\n    },\n  },\n  watch: {\n    orderInfo() {\n      if (Object.keys(this.orderInfo).length !== 0) {\n        this.orderPrice = this.orderInfo\n          .reduce((preValue, item) => {\n            return preValue + item.product_num * item.product_ptprice;\n          }, 0)\n          .toFixed(2);\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>\n"]}]}