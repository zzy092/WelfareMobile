{"remainingRequest":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\jdConfirmOrder\\JdConfirmOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\jdConfirmOrder\\JdConfirmOrder.vue","mtime":1617455204367},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEZWZBZGRyZXNzV2FwIGZyb20gImNvbXBvbmVudHMvY29udGVudC9jb25maXJtT3JkZXIvRGVmQWRkcmVzc1dyYXAudnVlIjsKaW1wb3J0IE9yZGVySW5mb1dyYXAgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2NvbmZpcm1PcmRlci9PcmRlckluZm9XcmFwLnZ1ZSI7CgppbXBvcnQgT3JkZXJOYXZCYXIgZnJvbSAiLi9jaGlsZENvbXBzL09yZGVyTmF2QmFyLnZ1ZSI7CmltcG9ydCBDaGVja091dCBmcm9tICIuL2NoaWxkQ29tcHMvQ2hlY2tPdXQiOwoKaW1wb3J0IHsgZ2V0TWFzdEFkZHJlc3MgfSBmcm9tICJuZXR3b3JrL2FkZHJlc3MiOwppbXBvcnQgeyBnZXRPcmRlckZyZWlnaHQsIHN1Ym1pdE9yZGVyIH0gZnJvbSAibmV0d29yay9qZE9yZGVyIjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIE9yZGVyTmF2QmFyLAogICAgRGVmQWRkcmVzc1dhcCwKICAgIE9yZGVySW5mb1dyYXAsCiAgICBDaGVja091dCwKICB9LAogIG5hbWU6ICJKZENvbmZpcm1PcmRlciIsCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuX2dldE1hc3RBZGRyZXNzKCk7CiAgICB0aGlzLl9zZXRPcmRlckluZm8oKTsKICAgIHRoaXMuX2dldE9yZGVyRnJlaWdodCgpOwogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRlZkFkZHJlc3M6IHt9LAogICAgICBvcmRlckluZm86IFtdLAogICAgICBjaGVja0luZm86IHt9LAogICAgICBmcmVpZ2h0OiAwLAogICAgICBvcmRlclByaWNlOiAwLAogICAgICBhZGRyZXNzSWQ6IDAsCiAgICAgIGlzZGVmQWRkcmVzczogZmFsc2UsCiAgICAgIGlzRnJlaWdodDogZmFsc2UsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgX3NldE9yZGVySW5mbygpIHsgLy/llYblk4Hor6bmg4UKICAgICAgY29uc3Qgc3V1bWl0VHlwZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnN1Ym1pdFR5cGU7CiAgICAgIC8vPT0xIOi0reeJqei9puaPkOS6pAogICAgICBpZiAoc3V1bWl0VHlwZSA9PSAiMSIpIHsKICAgICAgICBjb25zdCBjYXJ0TGlzdCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuY2FydExpc3Q7CiAgICAgICAgdGhpcy5vcmRlckluZm8gPSBjYXJ0TGlzdC5maWx0ZXIoKGl0ZW0pID0+IHsKICAgICAgICAgIHJldHVybiBpdGVtLmNoZWNrZWQ7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBfZ2V0TWFzdEFkZHJlc3MoKSB7IC8v6buY6K6k5pS26LSn5Zyw5Z2ACiAgICAgIGdldE1hc3RBZGRyZXNzKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLmlzZGVmQWRkcmVzcyA9IHRydWU7CiAgICAgICAgICB0aGlzLmFkZHJlc3NJZCA9IHJlcy5yZXN1bHQuaWQ7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KHsKICAgICAgICAgICAgdHlwZTogInNldERlZkFkZHJlc3MiLAogICAgICAgICAgICBkZWZBZGRyZXNzOiByZXMucmVzdWx0LmFyZWFfc3RyX2lkcywKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kZWZBZGRyZXNzID0gcmVzLnJlc3VsdDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIF9nZXRPcmRlckZyZWlnaHQoKSB7ICAvL+iuouWNlei/kOi0uQogICAgICBsZXQgcXVlcnlNb2RlbCA9IG5ldyBPYmplY3QoKTsKICAgICAgcXVlcnlNb2RlbC5kZWZBZGRyZXNzID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXREZWZBZGRyZXNzOwogICAgICBxdWVyeU1vZGVsLnNrdVV1bXMgPSB0aGlzLmdldFNrdSgpOwoKICAgICAgZ2V0T3JkZXJGcmVpZ2h0KHF1ZXJ5TW9kZWwpLnRoZW4oKHJlcykgPT4gewogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgdGhpcy5pc0ZyZWlnaHQgPSB0cnVlOwogICAgICAgICAgdGhpcy5mcmVpZ2h0ID0gcmVzLnJlc3VsdC5mcmVpZ2h0OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY29uZmlybU9yZGVyKCkgeyAgLy/mj5DkuqTorqLljZUKICAgICAgbGV0IHF1ZXJ5TW9kZWw9bmV3IE9iamVjdCgpOwogICAgICBxdWVyeU1vZGVsLmFkZHJlc3NJZD10aGlzLmFkZHJlc3NJZDsKICAgICAgcXVlcnlNb2RlbC5za3VzPXRoaXMuZ2V0U2t1KCk7CiAgICAgIHF1ZXJ5TW9kZWwucGF5TW9uZXk9dGhpcy5vcmRlclByaWNlK3RoaXMuZnJlaWdodDsKICAgICAgc3VibWl0T3JkZXIocXVlcnlNb2RlbCkudGhlbihyZXM9PnsKICAgICAgICBpZihyZXMuc3VjY2Vzcyl7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgY29uc29sZS5sb2coJ+aPkOS6pOiuouWNleaIkOWKnycpOwogICAgICAgICAgLy/mkLrluKborqLljZVpZCDot7Povawg5pSv5LuY6aG16Z2iCgogICAgICAgIH1lbHNlewogICAgICAgICAgY29uc29sZS5sb2cocmVzLnJlc3VsdE1lc3NhZ2UpOwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBnZXRTa3UoKSB7CiAgICAgIGxldCBsaXN0U2t1TW9kZWwgPSBbXTsKICAgICAgdGhpcy5vcmRlckluZm8uZm9yRWFjaCgoZWxlbWVudCkgPT4gewogICAgICAgIGxldCBza3VNb2RlbCA9IHt9OwogICAgICAgIHNrdU1vZGVsLnNrdUlkID0gZWxlbWVudC5za3VpZDsKICAgICAgICBza3VNb2RlbC5udW0gPSBlbGVtZW50LnByb2R1Y3RfbnVtOwogICAgICAgIGxpc3RTa3VNb2RlbC5wdXNoKHNrdU1vZGVsKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBsaXN0U2t1TW9kZWw7CiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIG9yZGVySW5mbygpIHsKICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMub3JkZXJJbmZvKS5sZW5ndGggIT09IDApIHsKICAgICAgICB0aGlzLm9yZGVyUHJpY2UgPSB0aGlzLm9yZGVySW5mbwogICAgICAgICAgLnJlZHVjZSgocHJlVmFsdWUsIGl0ZW0pID0+IHsKICAgICAgICAgICAgcmV0dXJuIHByZVZhbHVlICsgaXRlbS5wcm9kdWN0X251bSAqIGl0ZW0ucHJvZHVjdF9wdHByaWNlOwogICAgICAgICAgfSwgMCkKICAgICAgICAgIC50b0ZpeGVkKDIpOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["JdConfirmOrder.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JdConfirmOrder.vue","sourceRoot":"src/views/jdConfirmOrder","sourcesContent":["<template>\n  <div id=\"jdconfirmorder\" v-if=\"this.$route.query.submitType != undefined\">\n    <order-nav-bar />\n\n    <def-address-wap :defAddress=\"defAddress\" />\n    <order-info-wrap :orderInfo=\"orderInfo\" />\n    <check-out :orderPrice=\"orderPrice\" :freightPrice=\"freight\" />\n    <div v-if=\"isdefAddress&&isFreight\">\n      <button @click=\"confirmOrder\">在线支付</button>\n    </div>\n  </div>\n  <div v-else>\n    <h1>无效的请求</h1>\n  </div>\n</template>\n\n<script>\nimport DefAddressWap from \"components/content/confirmOrder/DefAddressWrap.vue\";\nimport OrderInfoWrap from \"components/content/confirmOrder/OrderInfoWrap.vue\";\n\nimport OrderNavBar from \"./childComps/OrderNavBar.vue\";\nimport CheckOut from \"./childComps/CheckOut\";\n\nimport { getMastAddress } from \"network/address\";\nimport { getOrderFreight, submitOrder } from \"network/jdOrder\";\nexport default {\n  components: {\n    OrderNavBar,\n    DefAddressWap,\n    OrderInfoWrap,\n    CheckOut,\n  },\n  name: \"JdConfirmOrder\",\n  created() {\n    this._getMastAddress();\n    this._setOrderInfo();\n    this._getOrderFreight();\n  },\n  data() {\n    return {\n      defAddress: {},\n      orderInfo: [],\n      checkInfo: {},\n      freight: 0,\n      orderPrice: 0,\n      addressId: 0,\n      isdefAddress: false,\n      isFreight: false,\n    };\n  },\n  methods: {\n    _setOrderInfo() { //商品详情\n      const suumitType = this.$route.query.submitType;\n      //==1 购物车提交\n      if (suumitType == \"1\") {\n        const cartList = this.$store.getters.cartList;\n        this.orderInfo = cartList.filter((item) => {\n          return item.checked;\n        });\n      }\n    },\n    _getMastAddress() { //默认收货地址\n      getMastAddress().then((res) => {\n        if (res.success) {\n          this.isdefAddress = true;\n          this.addressId = res.result.id;\n          console.log(res);\n          this.$store.commit({\n            type: \"setDefAddress\",\n            defAddress: res.result.area_str_ids,\n          });\n          this.defAddress = res.result;\n        }\n      });\n    },\n    _getOrderFreight() {  //订单运费\n      let queryModel = new Object();\n      queryModel.defAddress = this.$store.getters.getDefAddress;\n      queryModel.skuUums = this.getSku();\n\n      getOrderFreight(queryModel).then((res) => {\n        if (res.success) {\n          this.isFreight = true;\n          this.freight = res.result.freight;\n        }\n      });\n    },\n    confirmOrder() {  //提交订单\n      let queryModel=new Object();\n      queryModel.addressId=this.addressId;\n      queryModel.skus=this.getSku();\n      queryModel.payMoney=this.orderPrice+this.freight;\n      submitOrder(queryModel).then(res=>{\n        if(res.success){\n          console.log(res);\n          console.log('提交订单成功');\n          //携带订单id 跳转 支付页面\n\n        }else{\n          console.log(res.resultMessage);\n        }\n      })\n    },\n    getSku() {\n      let listSkuModel = [];\n      this.orderInfo.forEach((element) => {\n        let skuModel = {};\n        skuModel.skuId = element.skuid;\n        skuModel.num = element.product_num;\n        listSkuModel.push(skuModel);\n      });\n      return listSkuModel;\n    },\n  },\n  watch: {\n    orderInfo() {\n      if (Object.keys(this.orderInfo).length !== 0) {\n        this.orderPrice = this.orderInfo\n          .reduce((preValue, item) => {\n            return preValue + item.product_num * item.product_ptprice;\n          }, 0)\n          .toFixed(2);\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>\n"]}]}