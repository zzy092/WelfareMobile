{"remainingRequest":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\skuDetail\\SkuDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\skuDetail\\SkuDetail.vue","mtime":1617359770844},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qIGVzbGludC1kaXNhYmxlICovCmltcG9ydCBTY3JvbGwgZnJvbSAiY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCI7CgppbXBvcnQgRGV0YWlsTmF2QmFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxOYXZCYXIiOwppbXBvcnQgRGV0YWlsU3dpcGVyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxTd2lwZXIiOwppbXBvcnQgRGV0YWlsSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsSW5mbyI7CmltcG9ydCBEZXRhaWxTaW1pbGFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxTaW1pbGFyIjsKaW1wb3J0IERldGFpbFBhcmFtIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxQYXJhbSI7CmltcG9ydCBEZXRhaWxCb2R5IGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxCb2R5LnZ1ZSI7CgppbXBvcnQgRGV0YWlsQm90dG9tQmFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxCb3R0b21CYXIiOwoKaW1wb3J0IEJhY2tUb3AgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2JhY2tUb3AvQmFja1RvcCI7CmltcG9ydCB7IGdldFNrdURldGFpbCB9IGZyb20gIm5ldHdvcmsvc2t1RGV0YWlsIjsKaW1wb3J0IHsgYmFja1RvcE1peGluIH0gZnJvbSAiQC9jb21tb24vbWl4aW4iOwppbXBvcnQgeyBCQUNLVE9QX0RJU1RBTkNFIH0gZnJvbSAiQC9jb21tb24vY29uc3QiOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIERldGFpbE5hdkJhciwKICAgIFNjcm9sbCwKICAgIERldGFpbFN3aXBlciwKICAgIERldGFpbEluZm8sCiAgICBEZXRhaWxQYXJhbSwKICAgIERldGFpbEJvZHksCiAgICBEZXRhaWxTaW1pbGFyLAogICAgRGV0YWlsQm90dG9tQmFyLAogICAgQmFja1RvcCwKICB9LAogIG5hbWU6ICJTa3VEZXRhaWwiLAogIG1peGluczogW2JhY2tUb3BNaXhpbl0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNrdTogIiIsCiAgICAgIGN1cnJlbnRJbmRleDogMCwKICAgICAgdG9wSW1hZ2VzOiBbXSwKICAgICAgZ29vZHM6IHt9LAogICAgICBzZXJ2aWNlczogW10sCiAgICAgIHNrdVNpbWlsYXI6IFtdLAogICAgICB0aGVtZVRvcHM6IFtdLAogICAgICBzdG9ja01zZzogIiIsCiAgICAgIGdvb2RzTnVtYmVyOiAwLAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldERldGFpbERhdGEoKTsKICB9LAogIHVwZGF0ZWQoKSB7CiAgICAvLyDojrflj5bpnIDopoHnmoTlm5vkuKpvZmZzZXRUb3AKICAgIHRoaXMuX2dldE9mZnNldFRvcHMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIF9nZXRPZmZzZXRUb3BzKCkgewogICAgICB0aGlzLnRoZW1lVG9wcyA9IFtdOwogICAgICB0aGlzLnRoZW1lVG9wcy5wdXNoKHRoaXMuJHJlZnMuYmFzZS4kZWwub2Zmc2V0VG9wKTsKICAgICAgdGhpcy50aGVtZVRvcHMucHVzaCh0aGlzLiRyZWZzLnBhcmFtLiRlbC5vZmZzZXRUb3ApOwogICAgICB0aGlzLnRoZW1lVG9wcy5wdXNoKHRoaXMuJHJlZnMuYm9keS4kZWwub2Zmc2V0VG9wKTsKICAgICAgdGhpcy50aGVtZVRvcHMucHVzaChOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0sCgogICAgLy/ojrflj5bllYblk4Hkv6Hmga8KICAgIGdldERldGFpbERhdGEoKSB7CiAgICAgIC8v6I635Y+W5ZWG5ZOBc2t1CiAgICAgIGNvbnN0IHNrdSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnNrdTsKICAgICAgdGhpcy5za3UgPSBza3U7CgogICAgICAvL+iOt+WPluivpuaDhQogICAgICBnZXRTa3VEZXRhaWwoc2t1KS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgICAvL+WVhuWTgei9ruaSreWbvgogICAgICAgICAgdGhpcy50b3BJbWFnZXMgPSByZXMucmVzdWx0LnNrdUltYWdzOwogICAgICAgICAgLy/lkI3np7DkuI7ku7fmoLwKICAgICAgICAgIHRoaXMuZ29vZHMgPSByZXMucmVzdWx0Lmdvb2RzOwogICAgICAgICAgLy835aSp5peg55CG55Sx44CB6Ieq6JClCiAgICAgICAgICB0aGlzLnNlcnZpY2VzID0gcmVzLnJlc3VsdC5nb29kc1NlcnZpY2U7CiAgICAgICAgICAvL+inhOagvAogICAgICAgICAgdGhpcy5za3VTaW1pbGFyID0gcmVzLnJlc3VsdC5za3VTaW1pbGFyOwogICAgICAgICAgLy9wYXJhbQogICAgICAgICAgdGhpcy5wYXJhbUluZm8gPSByZXMucmVzdWx0Lmdvb2RzLnBhcmFtOwogICAgICAgICAgLy/lupPlrZgKICAgICAgICAgIHRoaXMuc3RvY2tNc2cgPSByZXMucmVzdWx0LnN0b2NrTXNnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgX2xpc3RlblNjcm9sbFRoZW1lKHBvc2l0aW9uKSB7CiAgICAgIGlmIChPYmplY3Qua2V5cyh0aGVtZVRvcHMpLmxlbmd0aCAhPT0gMCkgewogICAgICAgIGxldCBsZW5ndGggPSB0aGlzLnRoZW1lVG9wcy5sZW5ndGg7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgbGV0IGlQb3MgPSB0aGlzLnRoZW1lVG9wc1tpXTsKICAgICAgICAgIC8qKgogICAgICAgICAgICog5Yik5pat55qE5pa55qGIOgogICAgICAgICAgICogIOaWueahiOS4gDoKICAgICAgICAgICAqICAgIOadoeS7tjogKGkgPCAobGVuZ3RoLTEpICYmIGN1cnJlbnRQb3MgPj0gaVBvcyAmJiBjdXJyZW50UG9zIDwgdGhpcy50aGVtZVRvcHNbaSsxXSkgfHwgKGkgPT09IChsZW5ndGgtMSkgJiYgY3VycmVudFBvcyA+PSBpUG9zKSwKICAgICAgICAgICAqICAgIOS8mOeCuTog5LiN6ZyA6KaB5byV5YWl5YW25LuW55qE5YaF5a65LCDpgJrov4fpgLvovpHop6PlhrMKICAgICAgICAgICAqICAgIOe8uueCuTog5Yik5pat5p2h5Lu26L+H6ZW/LCDlubbkuJTkuI3lrrnmmJPnkIbop6MKICAgICAgICAgICAqICDmlrnmoYjkuow6CiAgICAgICAgICAgKiAgICDmnaHku7Y6IOe7mXRoZW1lVG9wc+acgOWQjua3u+WKoOS4gOS4quW+iOWkp+eahOWAvCwg55So5LqO5ZKM5pyA5ZCO5LiA5Liq5Li76aKY55qEdG9w6L+b6KGM5q+U6L6DLgogICAgICAgICAgICogICAg5LyY54K5OiDnroDmtIHmmI7kuoYsIOS+v+S6jueQhuinowogICAgICAgICAgICogICAg57y654K5OiDpnIDopoHlvJXlhaXkuIDkuKrovoPlpKfnmoRpbnTmlbDlrZcKICAgICAgICAgICAqIOeWkeaDkTog5Zyo56ys5LiA5Liq5Yik5pat5LitLCDkuLrku4DkuYjkuI3og73nm7TmjqXliKTmlq0oY3VycmVudFBvcyA+PSBpUG9zKeWNs+WPrz8KICAgICAgICAgICAqIOino+etlDog5q+U5aaC5Zyo5p+Q5LiA5LiqY3VycmVudFBvc+Wkp+S6juesrDDkuKrml7YsIOWwseS8mmJyZWFrLCDkuI3kvJrliKTmlq3lkI7pnaLnmoRp5LqGLgogICAgICAgICAgICovCiAgICAgICAgICBpZiAocG9zaXRpb24gPj0gaVBvcyAmJiBwb3NpdGlvbiA8IHRoaXMudGhlbWVUb3BzW2kgKyAxXSkgewogICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50SW5kZXggIT09IGkpIHsKICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IGk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGl0bGVDbGljayhpbmRleCkgewogICAgICB0aGlzLiRyZWZzLnNjcm9sbC5zY3JvbGxUbygwLCAtdGhpcy50aGVtZVRvcHNbaW5kZXhdLCAxMDApOwogICAgfSwKICAgIGNvbnRlbnRTY3JvbGwocG9zaXRpb24pIHsKICAgICAgLy8gMS7nm5HlkKxiYWNrVG9w55qE5pi+56S6CiAgICAgIHRoaXMuc2hvd0JhY2tUb3AgPSBwb3NpdGlvbi55IDwgLUJBQ0tUT1BfRElTVEFOQ0U7CgogICAgICAvL+ebkeWQrOa7muWKqOWIsOWTquS4gOS4quS4u+mimAogICAgICB0aGlzLl9saXN0ZW5TY3JvbGxUaGVtZSgtcG9zaXRpb24ueSk7CiAgICB9LAogICAgYWRkVG9DYXJ0KCkgewogICAgICB0aGlzLmdvb2RzTnVtYmVyKys7CiAgICAgIGNvbnN0IG9iaiA9IHt9OwogICAgICBvYmouc2t1aWQgPSB0aGlzLnNrdTsKICAgICAgb2JqLnByb2R1Y3RfbnVtID0gdGhpcy5nb29kc051bWJlcjsKICAgICAgb2JqLnByb2R1Y3RfbmFtZSA9IHRoaXMuZ29vZHMubmFtZTsKICAgICAgb2JqLnByb2R1Y3RfaW1nID0gdGhpcy5nb29kcy5tYXN0ZXJJbWFnZTsKICAgICAgb2JqLnByb2R1Y3RfamRwcmljZSA9IHRoaXMuZ29vZHMuamRQcmljZTsKICAgICAgb2JqLnByb2R1Y3RfcHRwcmljZSA9IHRoaXMuZ29vZHMucHRQcmljZTsKICAgICAgb2JqLnByb2R1Y3RfcHJpY2UgPSB0aGlzLmdvb2RzLnByaWNlOwogICAgICBvYmouc2FsZV92YWx1ZSA9IHRoaXMuZ29vZHMucHR0YXg7CiAgICAgIG9iai5zdG9ja01zZyA9IHRoaXMuc3RvY2tNc2c7CiAgICAgIG9iai5jaGVja2VkID0gdHJ1ZTsKCiAgICAgIC8v6YCa6L+Hc3RvcmXnmoRhY3Rpb25z5byC5q2l5aSE55CGIHZ1ZXjlr7nosaEKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImFkZENhcnQiLCB7IHNrdU1vZGVsOiBvYmogfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgfSk7CiAgICAgIC8vdXBkYXRlQ2FydE51bWJlcihvYmouc2t1aWQsb2JqLnByb2R1Y3RfbnVtKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["SkuDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SkuDetail.vue","sourceRoot":"src/views/skuDetail","sourcesContent":["<template>\n  <div id=\"detail\">\n    <detail-nav-bar\n      @itemClick=\"titleClick\"\n      :current-index=\"currentIndex\"\n    ></detail-nav-bar>\n    <scroll\n      class=\"content\"\n      ref=\"scroll\"\n      @scroll=\"contentScroll\"\n      :probe-type=\"3\"\n      :data=\"[topImages, goods, skuSimilar]\"\n    >\n      <detail-swiper ref=\"base\" :images=\"topImages\"></detail-swiper>\n      <detail-info\n        ref=\"param\"\n        :goods=\"goods\"\n        :services=\"services\"\n      ></detail-info>\n      <detail-similar :skuSimilar=\"skuSimilar\"></detail-similar>\n      <detail-param :goods=\"goods\"></detail-param>\n      <detail-body ref=\"body\" :goods=\"goods\"></detail-body>\n    </scroll>\n\n    <detail-bottom-bar @addToCart=\"addToCart\"></detail-bottom-bar>\n    <back-top @backTop=\"backTop\" class=\"back-top\" v-show=\"showBackTop\" />\n  </div>\n</template>\n\n<script>\n/* eslint-disable */\nimport Scroll from \"components/common/scroll/Scroll\";\n\nimport DetailNavBar from \"./childComps/DetailNavBar\";\nimport DetailSwiper from \"./childComps/DetailSwiper\";\nimport DetailInfo from \"./childComps/DetailInfo\";\nimport DetailSimilar from \"./childComps/DetailSimilar\";\nimport DetailParam from \"./childComps/DetailParam\";\nimport DetailBody from \"./childComps/DetailBody.vue\";\n\nimport DetailBottomBar from \"./childComps/DetailBottomBar\";\n\nimport BackTop from \"components/content/backTop/BackTop\";\nimport { getSkuDetail } from \"network/skuDetail\";\nimport { backTopMixin } from \"@/common/mixin\";\nimport { BACKTOP_DISTANCE } from \"@/common/const\";\n\nexport default {\n  components: {\n    DetailNavBar,\n    Scroll,\n    DetailSwiper,\n    DetailInfo,\n    DetailParam,\n    DetailBody,\n    DetailSimilar,\n    DetailBottomBar,\n    BackTop,\n  },\n  name: \"SkuDetail\",\n  mixins: [backTopMixin],\n  data() {\n    return {\n      sku: \"\",\n      currentIndex: 0,\n      topImages: [],\n      goods: {},\n      services: [],\n      skuSimilar: [],\n      themeTops: [],\n      stockMsg: \"\",\n      goodsNumber: 0,\n    };\n  },\n  created() {\n    this.getDetailData();\n  },\n  updated() {\n    // 获取需要的四个offsetTop\n    this._getOffsetTops();\n  },\n  methods: {\n    _getOffsetTops() {\n      this.themeTops = [];\n      this.themeTops.push(this.$refs.base.$el.offsetTop);\n      this.themeTops.push(this.$refs.param.$el.offsetTop);\n      this.themeTops.push(this.$refs.body.$el.offsetTop);\n      this.themeTops.push(Number.MAX_VALUE);\n    },\n\n    //获取商品信息\n    getDetailData() {\n      //获取商品sku\n      const sku = this.$route.query.sku;\n      this.sku = sku;\n\n      //获取详情\n      getSkuDetail(sku).then((res) => {\n        if (res.success) {\n          console.log(res);\n          //商品轮播图\n          this.topImages = res.result.skuImags;\n          //名称与价格\n          this.goods = res.result.goods;\n          //7天无理由、自营\n          this.services = res.result.goodsService;\n          //规格\n          this.skuSimilar = res.result.skuSimilar;\n          //param\n          this.paramInfo = res.result.goods.param;\n          //库存\n          this.stockMsg = res.result.stockMsg;\n        } else {\n          console.log(res);\n        }\n      });\n    },\n    _listenScrollTheme(position) {\n      if (Object.keys(themeTops).length !== 0) {\n        let length = this.themeTops.length;\n        for (let i = 0; i < length; i++) {\n          let iPos = this.themeTops[i];\n          /**\n           * 判断的方案:\n           *  方案一:\n           *    条件: (i < (length-1) && currentPos >= iPos && currentPos < this.themeTops[i+1]) || (i === (length-1) && currentPos >= iPos),\n           *    优点: 不需要引入其他的内容, 通过逻辑解决\n           *    缺点: 判断条件过长, 并且不容易理解\n           *  方案二:\n           *    条件: 给themeTops最后添加一个很大的值, 用于和最后一个主题的top进行比较.\n           *    优点: 简洁明了, 便于理解\n           *    缺点: 需要引入一个较大的int数字\n           * 疑惑: 在第一个判断中, 为什么不能直接判断(currentPos >= iPos)即可?\n           * 解答: 比如在某一个currentPos大于第0个时, 就会break, 不会判断后面的i了.\n           */\n          if (position >= iPos && position < this.themeTops[i + 1]) {\n            if (this.currentIndex !== i) {\n              this.currentIndex = i;\n            }\n            break;\n          }\n        }\n      }\n    },\n    titleClick(index) {\n      this.$refs.scroll.scrollTo(0, -this.themeTops[index], 100);\n    },\n    contentScroll(position) {\n      // 1.监听backTop的显示\n      this.showBackTop = position.y < -BACKTOP_DISTANCE;\n\n      //监听滚动到哪一个主题\n      this._listenScrollTheme(-position.y);\n    },\n    addToCart() {\n      this.goodsNumber++;\n      const obj = {};\n      obj.skuid = this.sku;\n      obj.product_num = this.goodsNumber;\n      obj.product_name = this.goods.name;\n      obj.product_img = this.goods.masterImage;\n      obj.product_jdprice = this.goods.jdPrice;\n      obj.product_ptprice = this.goods.ptPrice;\n      obj.product_price = this.goods.price;\n      obj.sale_value = this.goods.pttax;\n      obj.stockMsg = this.stockMsg;\n      obj.checked = true;\n\n      //通过store的actions异步处理 vuex对象\n      this.$store.dispatch(\"addCart\", { skuModel: obj }).then((res) => {\n        console.log(res);\n      });\n      //updateCartNumber(obj.skuid,obj.product_num);\n    },\n  },\n};\n</script>\n\n<style scoped>\n#detail {\n  height: 100vh;\n  position: relative;\n  z-index: 1;\n  background-color: #fff;\n}\n\n.content {\n  position: absolute;\n  top: 44px;\n  bottom: 60px;\n}\n\n.back-top {\n  position: fixed;\n  right: 10px;\n  bottom: 65px;\n}\n</style>\n"]}]}