{"remainingRequest":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\skuDetail\\SkuDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\skuDetail\\SkuDetail.vue","mtime":1617247443416},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qIGVzbGludC1kaXNhYmxlICovCmltcG9ydCBTY3JvbGwgZnJvbSAiY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCI7CgppbXBvcnQgRGV0YWlsTmF2QmFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxOYXZCYXIiOwppbXBvcnQgRGV0YWlsU3dpcGVyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxTd2lwZXIiOwppbXBvcnQgRGV0YWlsSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsSW5mbyI7CmltcG9ydCBEZXRhaWxTaW1pbGFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxTaW1pbGFyIjsKaW1wb3J0IERldGFpbFBhcmFtIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxQYXJhbSI7CmltcG9ydCBEZXRhaWxCb2R5IGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxCb2R5LnZ1ZSI7CgppbXBvcnQgRGV0YWlsQm90dG9tQmFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxCb3R0b21CYXIiOwoKaW1wb3J0IEJhY2tUb3AgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2JhY2tUb3AvQmFja1RvcCI7CmltcG9ydCB7IGdldFNrdURldGFpbCB9IGZyb20gIm5ldHdvcmsvc2t1RGV0YWlsIjsKaW1wb3J0IHsgYmFja1RvcE1peGluIH0gZnJvbSAiQC9jb21tb24vbWl4aW4iOwppbXBvcnQgeyBCQUNLVE9QX0RJU1RBTkNFIH0gZnJvbSAiQC9jb21tb24vY29uc3QiOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIERldGFpbE5hdkJhciwKICAgIFNjcm9sbCwKICAgIERldGFpbFN3aXBlciwKICAgIERldGFpbEluZm8sCiAgICBEZXRhaWxQYXJhbSwKICAgIERldGFpbEJvZHksCiAgICBEZXRhaWxTaW1pbGFyLAogICAgRGV0YWlsQm90dG9tQmFyLAogICAgQmFja1RvcCwKICB9LAogIG5hbWU6ICJTa3VEZXRhaWwiLAogIG1peGluczogW2JhY2tUb3BNaXhpbl0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNrdTogIiIsCiAgICAgIGN1cnJlbnRJbmRleDogMCwKICAgICAgdG9wSW1hZ2VzOiBbXSwKICAgICAgZ29vZHM6IHt9LAogICAgICBzZXJ2aWNlczogW10sCiAgICAgIHNrdVNpbWlsYXI6IFtdLAogICAgICB0aGVtZVRvcHM6IFtdLAogICAgICBzdG9ja01zZzogJycsCiAgICAgIGdvb2RzTnVtYmVyOjAKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXREZXRhaWxEYXRhKCk7CiAgfSwKICB1cGRhdGVkKCkgewogICAgLy8g6I635Y+W6ZyA6KaB55qE5Zub5Liqb2Zmc2V0VG9wCiAgICB0aGlzLl9nZXRPZmZzZXRUb3BzKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBfZ2V0T2Zmc2V0VG9wcygpIHsKICAgICAgdGhpcy50aGVtZVRvcHMgPSBbXTsKICAgICAgdGhpcy50aGVtZVRvcHMucHVzaCh0aGlzLiRyZWZzLmJhc2UuJGVsLm9mZnNldFRvcCk7CiAgICAgIHRoaXMudGhlbWVUb3BzLnB1c2godGhpcy4kcmVmcy5wYXJhbS4kZWwub2Zmc2V0VG9wKTsKICAgICAgdGhpcy50aGVtZVRvcHMucHVzaCh0aGlzLiRyZWZzLmJvZHkuJGVsLm9mZnNldFRvcCk7CiAgICAgIHRoaXMudGhlbWVUb3BzLnB1c2goTnVtYmVyLk1BWF9WQUxVRSk7CiAgICB9LAoKICAgIC8v6I635Y+W5ZWG5ZOB5L+h5oGvCiAgICBnZXREZXRhaWxEYXRhKCkgewogICAgICAvL+iOt+WPluWVhuWTgXNrdQogICAgICBjb25zdCBza3UgPSB0aGlzLiRyb3V0ZS5xdWVyeS5za3U7CiAgICAgIHRoaXMuc2t1ID0gc2t1OwoKICAgICAgLy/ojrflj5bor6bmg4UKICAgICAgZ2V0U2t1RGV0YWlsKHNrdSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgLy/llYblk4Hova7mkq3lm74KICAgICAgICAgIHRoaXMudG9wSW1hZ2VzID0gcmVzLnJlc3VsdC5za3VJbWFnczsKICAgICAgICAgIC8v5ZCN56ew5LiO5Lu35qC8CiAgICAgICAgICB0aGlzLmdvb2RzID0gcmVzLnJlc3VsdC5nb29kczsKICAgICAgICAgIC8vN+WkqeaXoOeQhueUseOAgeiHquiQpQogICAgICAgICAgdGhpcy5zZXJ2aWNlcyA9IHJlcy5yZXN1bHQuZ29vZHNTZXJ2aWNlOwogICAgICAgICAgLy/op4TmoLwKICAgICAgICAgIHRoaXMuc2t1U2ltaWxhciA9IHJlcy5yZXN1bHQuc2t1U2ltaWxhcjsKICAgICAgICAgIC8vcGFyYW0KICAgICAgICAgIHRoaXMucGFyYW1JbmZvID0gcmVzLnJlc3VsdC5nb29kcy5wYXJhbTsKICAgICAgICAgIC8v5bqT5a2YCiAgICAgICAgICB0aGlzLnN0b2NrTXNnID0gIHJlcy5yZXN1bHQuc3RvY2tNc2c7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBfbGlzdGVuU2Nyb2xsVGhlbWUocG9zaXRpb24pIHsKICAgICAgbGV0IGxlbmd0aCA9IHRoaXMudGhlbWVUb3BzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGxldCBpUG9zID0gdGhpcy50aGVtZVRvcHNbaV07CiAgICAgICAgLyoqCiAgICAgICAgICog5Yik5pat55qE5pa55qGIOgogICAgICAgICAqICDmlrnmoYjkuIA6CiAgICAgICAgICogICAg5p2h5Lu2OiAoaSA8IChsZW5ndGgtMSkgJiYgY3VycmVudFBvcyA+PSBpUG9zICYmIGN1cnJlbnRQb3MgPCB0aGlzLnRoZW1lVG9wc1tpKzFdKSB8fCAoaSA9PT0gKGxlbmd0aC0xKSAmJiBjdXJyZW50UG9zID49IGlQb3MpLAogICAgICAgICAqICAgIOS8mOeCuTog5LiN6ZyA6KaB5byV5YWl5YW25LuW55qE5YaF5a65LCDpgJrov4fpgLvovpHop6PlhrMKICAgICAgICAgKiAgICDnvLrngrk6IOWIpOaWreadoeS7tui/h+mVvywg5bm25LiU5LiN5a655piT55CG6KejCiAgICAgICAgICogIOaWueahiOS6jDoKICAgICAgICAgKiAgICDmnaHku7Y6IOe7mXRoZW1lVG9wc+acgOWQjua3u+WKoOS4gOS4quW+iOWkp+eahOWAvCwg55So5LqO5ZKM5pyA5ZCO5LiA5Liq5Li76aKY55qEdG9w6L+b6KGM5q+U6L6DLgogICAgICAgICAqICAgIOS8mOeCuTog566A5rSB5piO5LqGLCDkvr/kuo7nkIbop6MKICAgICAgICAgKiAgICDnvLrngrk6IOmcgOimgeW8leWFpeS4gOS4qui+g+Wkp+eahGludOaVsOWtlwogICAgICAgICAqIOeWkeaDkTog5Zyo56ys5LiA5Liq5Yik5pat5LitLCDkuLrku4DkuYjkuI3og73nm7TmjqXliKTmlq0oY3VycmVudFBvcyA+PSBpUG9zKeWNs+WPrz8KICAgICAgICAgKiDop6PnrZQ6IOavlOWmguWcqOafkOS4gOS4qmN1cnJlbnRQb3PlpKfkuo7nrKww5Liq5pe2LCDlsLHkvJpicmVhaywg5LiN5Lya5Yik5pat5ZCO6Z2i55qEaeS6hi4KICAgICAgICAgKi8KICAgICAgICBpZiAocG9zaXRpb24gPj0gaVBvcyAmJiBwb3NpdGlvbiA8IHRoaXMudGhlbWVUb3BzW2kgKyAxXSkgewogICAgICAgICAgaWYgKHRoaXMuY3VycmVudEluZGV4ICE9PSBpKSB7CiAgICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gaTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRpdGxlQ2xpY2soaW5kZXgpIHsKICAgICAgdGhpcy4kcmVmcy5zY3JvbGwuc2Nyb2xsVG8oMCwgLXRoaXMudGhlbWVUb3BzW2luZGV4XSwgMTAwKTsKICAgIH0sCiAgICBjb250ZW50U2Nyb2xsKHBvc2l0aW9uKSB7CiAgICAgIC8vIDEu55uR5ZCsYmFja1RvcOeahOaYvuekugogICAgICB0aGlzLnNob3dCYWNrVG9wID0gcG9zaXRpb24ueSA8IC1CQUNLVE9QX0RJU1RBTkNFOwoKICAgICAgLy/nm5HlkKzmu5rliqjliLDlk6rkuIDkuKrkuLvpopgKICAgICAgdGhpcy5fbGlzdGVuU2Nyb2xsVGhlbWUoLXBvc2l0aW9uLnkpOwogICAgfSwKICAgIGFkZFRvQ2FydCgpIHsKICAgICAgdGhpcy5nb29kc051bWJlcisrCiAgICAgIGNvbnN0IG9iaiA9IHt9OwogICAgICBvYmouc2t1aWQgPSB0aGlzLnNrdTsKICAgICAgb2JqLnByb2R1Y3RfbnVtID0gdGhpcy5nb29kc051bWJlcjsKICAgICAgb2JqLnByb2R1Y3RfbmFtZSA9IHRoaXMuZ29vZHMubmFtZTsKICAgICAgb2JqLnByb2R1Y3RfaW1nID0gdGhpcy5nb29kcy5tYXN0ZXJJbWFnZTsKICAgICAgb2JqLnByb2R1Y3RfamRwcmljZSA9IHRoaXMuZ29vZHMuamRQcmljZTsKICAgICAgb2JqLnByb2R1Y3RfcHRwcmljZSA9IHRoaXMuZ29vZHMucHRQcmljZTsKICAgICAgb2JqLnByb2R1Y3RfcHJpY2UgPSB0aGlzLmdvb2RzLnByaWNlOwogICAgICBvYmouc2FsZV92YWx1ZSA9IHRoaXMuZ29vZHMucHR0YXg7CiAgICAgIG9iai5zdG9ja01zZyA9IHRoaXMuc3RvY2tNc2c7CiAgICAgIG9iai5jaGVja2VkID0gdHJ1ZTsKCiAgICAgIC8v6YCa6L+Hc3RvcmXnmoRhY3Rpb25z5byC5q2l5aSE55CGIHZ1ZXjlr7nosaEKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImFkZENhcnQiLCB7IHNrdU1vZGVsOiBvYmogfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgfSk7CiAgICAgIC8vdXBkYXRlQ2FydE51bWJlcihvYmouc2t1aWQsb2JqLnByb2R1Y3RfbnVtKTsKICAgIH0sCiAgfQp9Owo="},{"version":3,"sources":["SkuDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SkuDetail.vue","sourceRoot":"src/views/skuDetail","sourcesContent":["<template>\n  <div id=\"detail\">\n    <detail-nav-bar\n      @itemClick=\"titleClick\"\n      :current-index=\"currentIndex\"\n    ></detail-nav-bar>\n    <scroll\n      class=\"content\"\n      ref=\"scroll\"\n      @scroll=\"contentScroll\"\n      :probe-type=\"3\"\n      :data=\"[topImages, goods, skuSimilar]\"\n    >\n      <detail-swiper ref=\"base\" :images=\"topImages\"></detail-swiper>\n      <detail-info\n        ref=\"param\"\n        :goods=\"goods\"\n        :services=\"services\"\n      ></detail-info>\n      <detail-similar :skuSimilar=\"skuSimilar\"></detail-similar>\n      <detail-param :goods=\"goods\"></detail-param>\n      <detail-body ref=\"body\" :goods=\"goods\"></detail-body>\n    </scroll>\n\n    <detail-bottom-bar @addToCart=\"addToCart\"></detail-bottom-bar>\n    <back-top @backTop=\"backTop\" class=\"back-top\" v-show=\"showBackTop\" />\n  </div>\n</template>\n\n<script>\n/* eslint-disable */\nimport Scroll from \"components/common/scroll/Scroll\";\n\nimport DetailNavBar from \"./childComps/DetailNavBar\";\nimport DetailSwiper from \"./childComps/DetailSwiper\";\nimport DetailInfo from \"./childComps/DetailInfo\";\nimport DetailSimilar from \"./childComps/DetailSimilar\";\nimport DetailParam from \"./childComps/DetailParam\";\nimport DetailBody from \"./childComps/DetailBody.vue\";\n\nimport DetailBottomBar from \"./childComps/DetailBottomBar\";\n\nimport BackTop from \"components/content/backTop/BackTop\";\nimport { getSkuDetail } from \"network/skuDetail\";\nimport { backTopMixin } from \"@/common/mixin\";\nimport { BACKTOP_DISTANCE } from \"@/common/const\";\n\nexport default {\n  components: {\n    DetailNavBar,\n    Scroll,\n    DetailSwiper,\n    DetailInfo,\n    DetailParam,\n    DetailBody,\n    DetailSimilar,\n    DetailBottomBar,\n    BackTop,\n  },\n  name: \"SkuDetail\",\n  mixins: [backTopMixin],\n  data() {\n    return {\n      sku: \"\",\n      currentIndex: 0,\n      topImages: [],\n      goods: {},\n      services: [],\n      skuSimilar: [],\n      themeTops: [],\n      stockMsg: '',\n      goodsNumber:0\n    };\n  },\n  created() {\n    this.getDetailData();\n  },\n  updated() {\n    // 获取需要的四个offsetTop\n    this._getOffsetTops();\n  },\n  methods: {\n    _getOffsetTops() {\n      this.themeTops = [];\n      this.themeTops.push(this.$refs.base.$el.offsetTop);\n      this.themeTops.push(this.$refs.param.$el.offsetTop);\n      this.themeTops.push(this.$refs.body.$el.offsetTop);\n      this.themeTops.push(Number.MAX_VALUE);\n    },\n\n    //获取商品信息\n    getDetailData() {\n      //获取商品sku\n      const sku = this.$route.query.sku;\n      this.sku = sku;\n\n      //获取详情\n      getSkuDetail(sku).then((res) => {\n        if (res.success) {\n          console.log(res);\n          //商品轮播图\n          this.topImages = res.result.skuImags;\n          //名称与价格\n          this.goods = res.result.goods;\n          //7天无理由、自营\n          this.services = res.result.goodsService;\n          //规格\n          this.skuSimilar = res.result.skuSimilar;\n          //param\n          this.paramInfo = res.result.goods.param;\n          //库存\n          this.stockMsg =  res.result.stockMsg;\n        } else {\n          console.log(res);\n        }\n      });\n    },\n    _listenScrollTheme(position) {\n      let length = this.themeTops.length;\n      for (let i = 0; i < length; i++) {\n        let iPos = this.themeTops[i];\n        /**\n         * 判断的方案:\n         *  方案一:\n         *    条件: (i < (length-1) && currentPos >= iPos && currentPos < this.themeTops[i+1]) || (i === (length-1) && currentPos >= iPos),\n         *    优点: 不需要引入其他的内容, 通过逻辑解决\n         *    缺点: 判断条件过长, 并且不容易理解\n         *  方案二:\n         *    条件: 给themeTops最后添加一个很大的值, 用于和最后一个主题的top进行比较.\n         *    优点: 简洁明了, 便于理解\n         *    缺点: 需要引入一个较大的int数字\n         * 疑惑: 在第一个判断中, 为什么不能直接判断(currentPos >= iPos)即可?\n         * 解答: 比如在某一个currentPos大于第0个时, 就会break, 不会判断后面的i了.\n         */\n        if (position >= iPos && position < this.themeTops[i + 1]) {\n          if (this.currentIndex !== i) {\n            this.currentIndex = i;\n          }\n          break;\n        }\n      }\n    },\n    titleClick(index) {\n      this.$refs.scroll.scrollTo(0, -this.themeTops[index], 100);\n    },\n    contentScroll(position) {\n      // 1.监听backTop的显示\n      this.showBackTop = position.y < -BACKTOP_DISTANCE;\n\n      //监听滚动到哪一个主题\n      this._listenScrollTheme(-position.y);\n    },\n    addToCart() {\n      this.goodsNumber++\n      const obj = {};\n      obj.skuid = this.sku;\n      obj.product_num = this.goodsNumber;\n      obj.product_name = this.goods.name;\n      obj.product_img = this.goods.masterImage;\n      obj.product_jdprice = this.goods.jdPrice;\n      obj.product_ptprice = this.goods.ptPrice;\n      obj.product_price = this.goods.price;\n      obj.sale_value = this.goods.pttax;\n      obj.stockMsg = this.stockMsg;\n      obj.checked = true;\n\n      //通过store的actions异步处理 vuex对象\n      this.$store.dispatch(\"addCart\", { skuModel: obj }).then((res) => {\n        console.log(res);\n      });\n      //updateCartNumber(obj.skuid,obj.product_num);\n    },\n  }\n};\n</script>\n\n<style scoped>\n#detail {\n  height: 100vh;\n  position: relative;\n  z-index: 1;\n  background-color: #fff;\n}\n\n.content {\n  position: absolute;\n  top: 44px;\n  bottom: 60px;\n}\n\n.back-top {\n  position: fixed;\n  right: 10px;\n  bottom: 65px;\n}\n</style>\n"]}]}