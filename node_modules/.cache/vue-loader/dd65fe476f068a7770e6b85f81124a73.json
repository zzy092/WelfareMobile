{"remainingRequest":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\skuDetail\\SkuDetail.vue?vue&type=style&index=0&id=3613522c&scoped=true&lang=css&","dependencies":[{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\skuDetail\\SkuDetail.vue","mtime":1617359770844},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgojZGV0YWlsIHsKICBoZWlnaHQ6IDEwMHZoOwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB6LWluZGV4OiAxOwogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7Cn0KCi5jb250ZW50IHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiA0NHB4OwogIGJvdHRvbTogNjBweDsKfQoKLmJhY2stdG9wIHsKICBwb3NpdGlvbjogZml4ZWQ7CiAgcmlnaHQ6IDEwcHg7CiAgYm90dG9tOiA2NXB4Owp9Cg=="},{"version":3,"sources":["SkuDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmLA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"SkuDetail.vue","sourceRoot":"src/views/skuDetail","sourcesContent":["<template>\n  <div id=\"detail\">\n    <detail-nav-bar\n      @itemClick=\"titleClick\"\n      :current-index=\"currentIndex\"\n    ></detail-nav-bar>\n    <scroll\n      class=\"content\"\n      ref=\"scroll\"\n      @scroll=\"contentScroll\"\n      :probe-type=\"3\"\n      :data=\"[topImages, goods, skuSimilar]\"\n    >\n      <detail-swiper ref=\"base\" :images=\"topImages\"></detail-swiper>\n      <detail-info\n        ref=\"param\"\n        :goods=\"goods\"\n        :services=\"services\"\n      ></detail-info>\n      <detail-similar :skuSimilar=\"skuSimilar\"></detail-similar>\n      <detail-param :goods=\"goods\"></detail-param>\n      <detail-body ref=\"body\" :goods=\"goods\"></detail-body>\n    </scroll>\n\n    <detail-bottom-bar @addToCart=\"addToCart\"></detail-bottom-bar>\n    <back-top @backTop=\"backTop\" class=\"back-top\" v-show=\"showBackTop\" />\n  </div>\n</template>\n\n<script>\n/* eslint-disable */\nimport Scroll from \"components/common/scroll/Scroll\";\n\nimport DetailNavBar from \"./childComps/DetailNavBar\";\nimport DetailSwiper from \"./childComps/DetailSwiper\";\nimport DetailInfo from \"./childComps/DetailInfo\";\nimport DetailSimilar from \"./childComps/DetailSimilar\";\nimport DetailParam from \"./childComps/DetailParam\";\nimport DetailBody from \"./childComps/DetailBody.vue\";\n\nimport DetailBottomBar from \"./childComps/DetailBottomBar\";\n\nimport BackTop from \"components/content/backTop/BackTop\";\nimport { getSkuDetail } from \"network/skuDetail\";\nimport { backTopMixin } from \"@/common/mixin\";\nimport { BACKTOP_DISTANCE } from \"@/common/const\";\n\nexport default {\n  components: {\n    DetailNavBar,\n    Scroll,\n    DetailSwiper,\n    DetailInfo,\n    DetailParam,\n    DetailBody,\n    DetailSimilar,\n    DetailBottomBar,\n    BackTop,\n  },\n  name: \"SkuDetail\",\n  mixins: [backTopMixin],\n  data() {\n    return {\n      sku: \"\",\n      currentIndex: 0,\n      topImages: [],\n      goods: {},\n      services: [],\n      skuSimilar: [],\n      themeTops: [],\n      stockMsg: \"\",\n      goodsNumber: 0,\n    };\n  },\n  created() {\n    this.getDetailData();\n  },\n  updated() {\n    // 获取需要的四个offsetTop\n    this._getOffsetTops();\n  },\n  methods: {\n    _getOffsetTops() {\n      this.themeTops = [];\n      this.themeTops.push(this.$refs.base.$el.offsetTop);\n      this.themeTops.push(this.$refs.param.$el.offsetTop);\n      this.themeTops.push(this.$refs.body.$el.offsetTop);\n      this.themeTops.push(Number.MAX_VALUE);\n    },\n\n    //获取商品信息\n    getDetailData() {\n      //获取商品sku\n      const sku = this.$route.query.sku;\n      this.sku = sku;\n\n      //获取详情\n      getSkuDetail(sku).then((res) => {\n        if (res.success) {\n          console.log(res);\n          //商品轮播图\n          this.topImages = res.result.skuImags;\n          //名称与价格\n          this.goods = res.result.goods;\n          //7天无理由、自营\n          this.services = res.result.goodsService;\n          //规格\n          this.skuSimilar = res.result.skuSimilar;\n          //param\n          this.paramInfo = res.result.goods.param;\n          //库存\n          this.stockMsg = res.result.stockMsg;\n        } else {\n          console.log(res);\n        }\n      });\n    },\n    _listenScrollTheme(position) {\n      if (Object.keys(themeTops).length !== 0) {\n        let length = this.themeTops.length;\n        for (let i = 0; i < length; i++) {\n          let iPos = this.themeTops[i];\n          /**\n           * 判断的方案:\n           *  方案一:\n           *    条件: (i < (length-1) && currentPos >= iPos && currentPos < this.themeTops[i+1]) || (i === (length-1) && currentPos >= iPos),\n           *    优点: 不需要引入其他的内容, 通过逻辑解决\n           *    缺点: 判断条件过长, 并且不容易理解\n           *  方案二:\n           *    条件: 给themeTops最后添加一个很大的值, 用于和最后一个主题的top进行比较.\n           *    优点: 简洁明了, 便于理解\n           *    缺点: 需要引入一个较大的int数字\n           * 疑惑: 在第一个判断中, 为什么不能直接判断(currentPos >= iPos)即可?\n           * 解答: 比如在某一个currentPos大于第0个时, 就会break, 不会判断后面的i了.\n           */\n          if (position >= iPos && position < this.themeTops[i + 1]) {\n            if (this.currentIndex !== i) {\n              this.currentIndex = i;\n            }\n            break;\n          }\n        }\n      }\n    },\n    titleClick(index) {\n      this.$refs.scroll.scrollTo(0, -this.themeTops[index], 100);\n    },\n    contentScroll(position) {\n      // 1.监听backTop的显示\n      this.showBackTop = position.y < -BACKTOP_DISTANCE;\n\n      //监听滚动到哪一个主题\n      this._listenScrollTheme(-position.y);\n    },\n    addToCart() {\n      this.goodsNumber++;\n      const obj = {};\n      obj.skuid = this.sku;\n      obj.product_num = this.goodsNumber;\n      obj.product_name = this.goods.name;\n      obj.product_img = this.goods.masterImage;\n      obj.product_jdprice = this.goods.jdPrice;\n      obj.product_ptprice = this.goods.ptPrice;\n      obj.product_price = this.goods.price;\n      obj.sale_value = this.goods.pttax;\n      obj.stockMsg = this.stockMsg;\n      obj.checked = true;\n\n      //通过store的actions异步处理 vuex对象\n      this.$store.dispatch(\"addCart\", { skuModel: obj }).then((res) => {\n        console.log(res);\n      });\n      //updateCartNumber(obj.skuid,obj.product_num);\n    },\n  },\n};\n</script>\n\n<style scoped>\n#detail {\n  height: 100vh;\n  position: relative;\n  z-index: 1;\n  background-color: #fff;\n}\n\n.content {\n  position: absolute;\n  top: 44px;\n  bottom: 60px;\n}\n\n.back-top {\n  position: fixed;\n  right: 10px;\n  bottom: 65px;\n}\n</style>\n"]}]}