{"remainingRequest":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\home\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\src\\views\\home\\Home.vue","mtime":1617359864250},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\Welfare_New_System\\welfare_mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBNYWluVGFiQmFyIGZyb20gImNvbXBvbmVudHMvY29udGVudC9tYWluVGFiYmFyL01haW5UYWJCYXIudnVlIjsKaW1wb3J0IE5hdkJhciBmcm9tICJjb21wb25lbnRzL2NvbW1vbi9uYXZiYXIvTmF2QmFyIjsKaW1wb3J0IEhvbWVTd2lwZXIgZnJvbSAiLi9jaGlsZENvbXBzL0hvbWVTd2lwZXIiOwppbXBvcnQgUmVjb21tZW5kVmlldyBmcm9tICIuL2NoaWxkQ29tcHMvUmVjb21tZW5kVmlldyI7CmltcG9ydCBHb29kTGlzdCBmcm9tICIuL2NoaWxkQ29tcHMvR29vZHNMaXN0IjsKCmltcG9ydCBTY3JvbGwgZnJvbSAiY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCI7CmltcG9ydCBCYWNrVG9wIGZyb20gImNvbXBvbmVudHMvY29udGVudC9iYWNrVG9wL0JhY2tUb3AiOwoKLy9qcwppbXBvcnQgeyBnZXRIb21lTXVsdGlkYXRhLCBnZXRIb21lUHJvZHVjdHMgfSBmcm9tICJuZXR3b3JrL2hvbWUiOwppbXBvcnQgeyBkZWJ1bmNlIH0gZnJvbSAiY29tbW9uL3V0aWxzIjsKaW1wb3J0IHsgZ2V0Tm93Q2FydCB9IGZyb20gIm5ldHdvcmsvamRDYXJ0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiSG9tZSIsCiAgY29tcG9uZW50czogewogICAgTmF2QmFyLAogICAgSG9tZVN3aXBlciwKICAgIFJlY29tbWVuZFZpZXcsCiAgICBHb29kTGlzdCwKICAgIFNjcm9sbCwKICAgIEJhY2tUb3AsCiAgICBNYWluVGFiQmFyLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzc2hvd0JhY2tUb3A6IGZhbHNlLAogICAgICBwYWdlSW5kZXg6IDAsCiAgICAgIHBhZ2VTaXplOiA1MCwKICAgICAgcGFnZUNvdW50OiAwLAogICAgICBiYW5uZXJzOiBbXSwKICAgICAgcmVjb21tZW5kczogW10sCiAgICAgIHNob3dHb29kczogW10sCiAgICAgIHNhdmVZOiAwLAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICAvLzHjgIHpppbpobXmlbDmja4KICAgIHRoaXMuZ2V0U3dpcGVyQW5kUmVjb21tZW5kKCk7CiAgICB0aGlzLmdldFByb2R1Y3RzKHRoaXMucGFnZUluZGV4LCB0aGlzLnBhZ2VTaXplKTsKICAgIC8v6I635Y+W6LSt54mp6L2mCiAgICB0aGlzLmdldGNhcnQoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8v6L2u5pKt5LiO5YiG57G75L+h5oGvCiAgICBnZXRTd2lwZXJBbmRSZWNvbW1lbmQoKSB7CiAgICAgIGdldEhvbWVNdWx0aWRhdGEoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAvL2NvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgdGhpcy5iYW5uZXJzID0gcmVzLnJlc3VsdC5ob21lQ2Fyb3VzZWxJbWc7CiAgICAgICAgdGhpcy5yZWNvbW1lbmRzID0gcmVzLnJlc3VsdC5ob21lQ2F0ZWdvcnk7CiAgICAgIH0pOwogICAgfSwKICAgIC8v6aaW6aG15ZWG5ZOBCiAgICBnZXRQcm9kdWN0cygpIHsKICAgICAgdGhpcy5wYWdlSW5kZXggKz0gMTsKICAgICAgZ2V0SG9tZVByb2R1Y3RzKHRoaXMucGFnZUluZGV4LCB0aGlzLnBhZ2VTaXplKS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLnJlc3VsdENvZGUgPT0gIjAwMDAiICYmIHJlcy5yZXN1bHQgIT0gbnVsbCkgewogICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMucmVzdWx0Lmxpc3RTa3VzKTsKICAgICAgICAgIHRoaXMuc2hvd0dvb2RzLnB1c2goLi4ucmVzLnJlc3VsdC5saXN0U2t1cyk7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuc2hvd0dvb2RzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5wYWdlSW5kZXggLT0gMTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMuc2Nyb2xsLmZpbmlzaFB1bGxVcCgpOwogICAgICB9KTsKICAgIH0sCiAgICBiYWNrQ2xpY2soKSB7CiAgICAgIHRoaXMuJHJlZnMuc2Nyb2xsLnNjcm9sbFRvKDAsIDAsIDUwMCk7CiAgICB9LAogICAgY29udGVudFNjcm9sbChwb3NpdGlvbikgewogICAgICAvLyAgY29uc29sZS5sb2coJ+a7muWKqOS6i+S7tuiiq+ebkeWQrCcpCiAgICAgIC8vIGNvbnNvbGUubG9nKHBvc2l0aW9uKQogICAgICB0aGlzLmlzc2hvd0JhY2tUb3AgPSAtcG9zaXRpb24ueSA+IDMwOwogICAgfSwKICAgIGxvYWRNb3JlKCkgewogICAgICAvL+S4i+aLieWKoOi9veabtOWkmgogICAgICB0aGlzLmdldFByb2R1Y3RzKCk7CiAgICB9LAogICAgZ2V0Y2FydCgpIHsKICAgICAgZ2V0Tm93Q2FydCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgIGxldCBkYkNhcnRMaXN0ID0gcmVzLnJlc3VsdDsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIGlmIChyZXMgIT0gdW5kZWZpbmVkICYmIHJlcy5zdWNjZXNzID09IHRydWUpIHsKICAgICAgICAgIC8v6YGN5Y6G5pWw5o2u77yM5pu05pawIHZ1ZXgg6LSt54mp6L2m5pWw5o2uCiAgICAgICAgICBsZXQgdnVleENhcnRMaXN0ID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5jYXJ0TGlzdDsKICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh2dWV4Q2FydExpc3QpLmxlbmd0aCE9PTApIHsKICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGRiQ2FydExpc3QubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkYkNhcnRMaXN0W2luZGV4XTsKICAgICAgICAgICAgICB2YXIgaXNtb2RlbCA9IHZ1ZXhDYXJ0TGlzdC5maW5kKAogICAgICAgICAgICAgICAgKGl0ZW0pID0+IGl0ZW0uc2t1aWQgPT09IGVsZW1lbnQuc2t1aWQKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGlmIChpc21vZGVsKSB7CiAgICAgICAgICAgICAgICAvL+abtOaWsOaVsOmHj++8jOW6k+WtmO+8jOS7t+agvAogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KHsKICAgICAgICAgICAgICAgICAgdHlwZTogInVwZGF0ZUNhcnQiLAogICAgICAgICAgICAgICAgICBnZXRtb2RlbDogdGhpcy5fZ2V0Q2FydE1vZGVsKCksCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy/mt7vliqDlpKcgdnVleAogICAgICAgICAgICAgICAgdGhpcy5fYWRkQ2FydChlbGVtZW50KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBkYkNhcnRMaXN0ICE9IHVuZGVmaW5lZCAmJgogICAgICAgICAgICAgIE9iamVjdC5rZXlzKGRiQ2FydExpc3QpLmxlbmd0aCAhPT0gMAogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgZGJDYXJ0TGlzdC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgICAgIGxldCBlbGVtZW50ID0gZGJDYXJ0TGlzdFtpbmRleF07CiAgICAgICAgICAgICAgICB0aGlzLl9hZGRDYXJ0KGVsZW1lbnQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgX2FkZENhcnQoZWxlbWVudCkgewogICAgICBsZXQgb2JqID0gdGhpcy5fZ2V0Q2FydE1vZGVsKGVsZW1lbnQpOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoewogICAgICAgIHR5cGU6ICJhZGRDYXJ0IiwKICAgICAgICBpbmZvOiBvYmosCiAgICAgIH0pOwogICAgfSwKICAgIF9nZXRDYXJ0TW9kZWwoZWxlbWVudCkgewogICAgICBsZXQgb2JqID0ge307CiAgICAgIG9iai5za3VpZCA9IGVsZW1lbnQuc2t1aWQ7CiAgICAgIG9iai5wcm9kdWN0X251bSA9IGVsZW1lbnQubnVtYmVyOwogICAgICBvYmoucHJvZHVjdF9uYW1lID0gZWxlbWVudC5wcm9kdWN0TmFtZTsKICAgICAgb2JqLnByb2R1Y3RfaW1nID0gZWxlbWVudC5pbWc7CiAgICAgIG9iai5wcm9kdWN0X2pkcHJpY2UgPSBlbGVtZW50LnByb2R1Y3RKZFByaWNlOwogICAgICBvYmoucHJvZHVjdF9wdHByaWNlID0gZWxlbWVudC5wcm9kdWN0UHRQcmljZTsKICAgICAgb2JqLnByb2R1Y3RfcHJpY2UgPSBlbGVtZW50LnByb2R1Y3RQcmljZTsKICAgICAgb2JqLnNhbGVfdmFsdWUgPSBlbGVtZW50LnNhbGU7CiAgICAgIG9iai5zdG9ja01zZyA9IGVsZW1lbnQuc3RvY2tTdGF0ZURlc2M7CiAgICAgIG9iai5jaGVja2VkID0gdHJ1ZTsKICAgICAgcmV0dXJuIG9iajsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgLy8gMy7nm5HlkKxpdGVtIOS4reWbvueJhyDliqDovb3lrozmiJAg6LCD6Ziy5oqW5Ye95pWwLOS8mOWMluaAp+iDvQogICAgY29uc3QgcmVmcmVzaCA9IGRlYnVuY2UodGhpcy4kcmVmcy5zY3JvbGwucmVmcmVzaCwgMzAwKTsKICAgIHRoaXMuJGJ1cy4kb24oIml0ZW1JbWFnZWxvYWQiLCAoKSA9PiB7CiAgICAgIHJlZnJlc2goKTsKICAgIH0pOwogIH0sCiAgLy/nm5Hmjqfnu4Tku7bplIDmr4EKICBkZXN0cm95ZWQoKSB7CiAgICBjb25zb2xlLmxvZygi6ZSA5q+BIik7CiAgfSwKICAvLyDmtLvot4PvvIjpnIDopoHlnKhyb3V0ZXItdmlldyDlpJbljIXoo4XkuIDlsYIga2VlcC1hbGl2Ze+8iQogIGFjdGl2YXRlZCgpIHsKICAgIHRoaXMuJHJlZnMuc2Nyb2xsLmdldFNjcm9sbFkoMCwgdGhpcy5zYXZlWSwgMCk7CiAgICB0aGlzLiRyZWZzLnNjcm9sbC5yZWZyZXNoKCk7CiAgfSwKICAvLyDkuI3mtLvot4PnirbmgIEKICBkZWFjdGl2YXRlZCgpIHsKICAgIHRoaXMuc2F2ZVkgPSB0aGlzLiRyZWZzLnNjcm9sbC5nZXRTY3JvbGxZKCk7CiAgfSwKfTsK"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n  <div id=\"home\" class=\"wrapper\">\n    <nav-bar class=\"home-nav\"><div slot=\"center\">商场首页</div></nav-bar>\n    <scroll\n      class=\"content\"\n      ref=\"scroll\"\n      :probe-type=\"3\"\n      :pull-up-load=\"true\"\n      @scroll=\"contentScroll\"\n      @pullingUp=\"loadMore\"\n    >\n      <home-swiper :banners=\"banners\" />\n      <recommend-view :recommends=\"recommends\" />\n      <good-list :goods=\"showGoods\" />\n    </scroll>\n    <!--返回顶部-->\n    <back-top @click.native=\"backClick\" v-show=\"isshowBackTop\" />\n    <main-tab-bar />\n  </div>\n</template>\n\n<script>\nimport MainTabBar from \"components/content/mainTabbar/MainTabBar.vue\";\nimport NavBar from \"components/common/navbar/NavBar\";\nimport HomeSwiper from \"./childComps/HomeSwiper\";\nimport RecommendView from \"./childComps/RecommendView\";\nimport GoodList from \"./childComps/GoodsList\";\n\nimport Scroll from \"components/common/scroll/Scroll\";\nimport BackTop from \"components/content/backTop/BackTop\";\n\n//js\nimport { getHomeMultidata, getHomeProducts } from \"network/home\";\nimport { debunce } from \"common/utils\";\nimport { getNowCart } from \"network/jdCart\";\n\nexport default {\n  name: \"Home\",\n  components: {\n    NavBar,\n    HomeSwiper,\n    RecommendView,\n    GoodList,\n    Scroll,\n    BackTop,\n    MainTabBar,\n  },\n  data() {\n    return {\n      isshowBackTop: false,\n      pageIndex: 0,\n      pageSize: 50,\n      pageCount: 0,\n      banners: [],\n      recommends: [],\n      showGoods: [],\n      saveY: 0,\n    };\n  },\n  created() {\n    //1、首页数据\n    this.getSwiperAndRecommend();\n    this.getProducts(this.pageIndex, this.pageSize);\n    //获取购物车\n    this.getcart();\n  },\n  methods: {\n    //轮播与分类信息\n    getSwiperAndRecommend() {\n      getHomeMultidata().then((res) => {\n        //console.log(res);\n        this.banners = res.result.homeCarouselImg;\n        this.recommends = res.result.homeCategory;\n      });\n    },\n    //首页商品\n    getProducts() {\n      this.pageIndex += 1;\n      getHomeProducts(this.pageIndex, this.pageSize).then((res) => {\n        if (res.resultCode == \"0000\" && res.result != null) {\n          //console.log(res.result.listSkus);\n          this.showGoods.push(...res.result.listSkus);\n          //console.log(this.showGoods);\n        } else {\n          this.pageIndex -= 1;\n        }\n\n        this.$refs.scroll.finishPullUp();\n      });\n    },\n    backClick() {\n      this.$refs.scroll.scrollTo(0, 0, 500);\n    },\n    contentScroll(position) {\n      //  console.log('滚动事件被监听')\n      // console.log(position)\n      this.isshowBackTop = -position.y > 30;\n    },\n    loadMore() {\n      //下拉加载更多\n      this.getProducts();\n    },\n    getcart() {\n      getNowCart().then((res) => {\n        let dbCartList = res.result;\n        console.log(res);\n        if (res != undefined && res.success == true) {\n          //遍历数据，更新 vuex 购物车数据\n          let vuexCartList = this.$store.getters.cartList;\n          if (Object.keys(vuexCartList).length!==0) {\n            for (let index = 0; index < dbCartList.length; index++) {\n              var element = dbCartList[index];\n              var ismodel = vuexCartList.find(\n                (item) => item.skuid === element.skuid\n              );\n              if (ismodel) {\n                //更新数量，库存，价格\n                this.$store.commit({\n                  type: \"updateCart\",\n                  getmodel: this._getCartModel(),\n                });\n              } else {\n                //添加大 vuex\n                this._addCart(element);\n              }\n            }\n          } else {\n            if (\n              dbCartList != undefined &&\n              Object.keys(dbCartList).length !== 0\n            ) {\n              for (let index = 0; index < dbCartList.length; index++) {\n                let element = dbCartList[index];\n                this._addCart(element);\n              }\n            }\n          }\n        }\n      });\n    },\n    _addCart(element) {\n      let obj = this._getCartModel(element);\n      this.$store.commit({\n        type: \"addCart\",\n        info: obj,\n      });\n    },\n    _getCartModel(element) {\n      let obj = {};\n      obj.skuid = element.skuid;\n      obj.product_num = element.number;\n      obj.product_name = element.productName;\n      obj.product_img = element.img;\n      obj.product_jdprice = element.productJdPrice;\n      obj.product_ptprice = element.productPtPrice;\n      obj.product_price = element.productPrice;\n      obj.sale_value = element.sale;\n      obj.stockMsg = element.stockStateDesc;\n      obj.checked = true;\n      return obj;\n    },\n  },\n  mounted() {\n    // 3.监听item 中图片 加载完成 调防抖函数,优化性能\n    const refresh = debunce(this.$refs.scroll.refresh, 300);\n    this.$bus.$on(\"itemImageload\", () => {\n      refresh();\n    });\n  },\n  //监控组件销毁\n  destroyed() {\n    console.log(\"销毁\");\n  },\n  // 活跃（需要在router-view 外包装一层 keep-alive）\n  activated() {\n    this.$refs.scroll.getScrollY(0, this.saveY, 0);\n    this.$refs.scroll.refresh();\n  },\n  // 不活跃状态\n  deactivated() {\n    this.saveY = this.$refs.scroll.getScrollY();\n  },\n};\n</script>\n\n<style scoped>\n#home {\n  height: 100vh;\n  position: relative;\n}\n\n.home-nav {\n  background-color: var(--color-tint);\n  color: #fff;\n\n  position: relative;\n  left: 0;\n  right: 0;\n  top: 0;\n  z-index: 9;\n}\n\n.tab-control {\n  position: relative;\n  z-index: 9;\n}\n\n.content {\n  position: absolute;\n  top: 44px;\n  bottom: 49px;\n  left: 0;\n  right: 0;\n}\n</style>\n"]}]}